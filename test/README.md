# テスト実装について

このドキュメントでは、tts-mcpリポジトリのテスト実装について説明します。

## テスト環境

- **フレームワーク**: Jest
- **モックライブラリ**: mock-fs, sinon, nock
- **テストタイプ**: ユニットテスト、統合テスト

## テストファイル構造

- `test/utils.test.js` - ユーティリティ関数のテスト
- `test/api.test.js` - OpenAI API関連機能のテスト
- `test/mcp-server.test.js` - MCPサーバー機能のテスト
- `test/integration.test.js` - 統合テスト（デフォルトではスキップ）

## 実行方法

```bash
# 通常のテスト実行
npm test

# カバレッジレポート生成
npm run test:coverage

# 統合テスト実行（実際のAPIを使用するため注意）
NODE_ENV=integration npm test -- test/integration.test.js
```

## テストカバレッジ

現在のテストカバレッジ状況：

- **utils.js**: 95% 以上（非常に良好）
- **api.js**: 76%（改善の余地あり）
- **mcp-server.js**: 40%（大幅な改善が必要）
- **index.js**: 0%（テスト未実装）

## 今後の改善点

1. **MCPサーバーテストの強化**:
   - モックをより精緻化して、サーバー機能のテストカバレッジを向上させる

2. **index.jsのテスト追加**:
   - メインエントリーポイントのテストを実装

3. **統合テストの充実**:
   - MCPクライアントを模擬したテストの追加
   - エンドツーエンドテストの追加

4. **CI/CD連携**:
   - GitHub ActionsなどのCI環境でテストを自動実行
   - テスト実行をGit hookに組み込む

## セキュリティ注意事項

- テスト実行時は `.env` ファイルの実際のAPIキーが使用されないよう注意してください
- 統合テストを実行する場合は、必ずテスト用のAPIキーを使用してください
